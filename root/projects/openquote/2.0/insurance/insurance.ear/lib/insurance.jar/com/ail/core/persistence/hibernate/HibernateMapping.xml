<?xml version="1.0"?> 
<!DOCTYPE hibernate-mapping PUBLIC 
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN" 
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"> 

<hibernate-mapping>

    <class name="com.ail.insurance.policy.SavedPolicySummary" table="saved_policy_summary">
        <id name='systemId' type='long' column='id'>
            <generator class='native'/>
        </id>
        <version name='serialVersion' type='long' column='version'/>
        <property name='quotationNumber' type='string' column='quote_number'/>
        <property name='policyNumber' type='string' column='policy_number'/>
        <property name='quotationDate' type='date' column='quote_date'/>
        <property name='quotationExpiryDate' type='date' column='expiry_date'/>
        <property name='statusAsString' column='status' type='string'/>
        <property name='page' type='string' column='page'/>
        <component name='premium' class='com.ail.financial.CurrencyAmount'>
            <property name='amount' column='premium_amount'/>
            <property name='currencyAsString' column='premium_currency'/>
        </component>
        <property name='username' type='string' column='username'/>
        <property name='product' type='string' column='product'/>
        <property name='userSaved' type='boolean' column='user_saved'/>
        <property name='testCase' type='boolean' column='test_case'/>
        
        <joined-subclass name='com.ail.insurance.policy.SavedPolicy' table='saved_policy'>
            <key column='id'/>
            <property name='policyAsString' column='policy' type='text'/>
            <property name="quotationDocument" column='quotation_document' type='binary'/>
            <property name="invoiceDocument" column='invoice_document' type='binary'/>
            <property name="wordingDocument" column='wording_document' type='binary'/>
            <property name="certificateDocument" column='certificate_document' type='binary'/>
        </joined-subclass>
    </class>

    <query name='get.savedPolicySummary.by.username.and.product'>
        from com.ail.insurance.policy.SavedPolicySummary as summary where summary.userSaved=true and summary.username=? and summary.product=? and summary.statusAsString='QUOTATION'
    </query> 

    <query name='get.savedPolicySummary.by.username'>
        from com.ail.insurance.policy.SavedPolicySummary as summary where summary.userSaved=true and summary.username=? and summary.statusAsString='QUOTATION'
    </query> 

    <query name='get.savedPolicy.by.quotationNumber'>
        from com.ail.insurance.policy.SavedPolicy policy fetch all properties where policy.quotationNumber=?
    </query> 
    
    <query name='get.savedPolicy.by.systemId'>
        from com.ail.insurance.policy.SavedPolicy policy fetch all properties where policy.systemId=?
    </query> 
    
    <query name='get.savedPolicy.by.policyNumber'>
        from com.ail.insurance.policy.SavedPolicy policy fetch all properties where policy.policyNumber=?
    </query> 
    
</hibernate-mapping> 
