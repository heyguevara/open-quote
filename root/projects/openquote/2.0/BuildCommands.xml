<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
 Ant build file for starting utilities & servers etc..
-->

<project default="" name="openquote:commands">
  <import file="./BuildSettings.xml" />

  <target name="liferay: start server" description="start the liferay server">
    <start-liferay-macro />
  </target>

  <target name="liferay: stop server" description="start the liferay server">
    <stop-liferay-macro />
  </target>

  <target name="liferay: force deployment scan" description="force liferay to scan 'deploy/' for changes">
    <kick-liferay-macro />
  </target>

  <target name="liferay: export repository" description="Export the content repository into the source tree">
    <content-download-export-macro />
  </target>

  <target name="liferay: mount product space" description="Mount Product space in Liferay as a file system">
    <mount-product-space-macro/>
  </target>

  <target name="liferay: unmount product space" description="Unmount Product space from local filesystem">
    <unmount-product-space-macro/>
  </target>
    
  <target name="openquote: clear server cache" description="Clear the config cache in liferay">
    <configuration-macro username="${dbusername}" password="${dbpassword}" operation="clearConfigurationCache" />
  </target>

  <target name="openquote: reset configurations" description="reset all the ail configurations">

   	<ail-aggregate-annotated-configurations output-jar="${ear.dir}/lib/core.jar">
      <paths>
        <dirset dir="${test.dir}" includes="unit-test.jar, integration-test.jar"/>
        <dirset dir="${ear.dir}/lib" includes="*.jar" />
        <dirset dir="${ear.dir}" includes="*.jar" />
        <dirset dir="${ear.dir}" includes="*.war/WEB-INF/classes" />
      </paths>
   	</ail-aggregate-annotated-configurations>

    <configuration-macro username="${dbusername}" password="${dbpassword}" operation="resetAllConfigurations" />
    <configuration-macro username="${dbusername}" password="${dbpassword}" operation="clearConfigurationCache" />

  </target>
</project>